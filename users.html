<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Teste – Usuários</title>
</head>
<body>

<h1>Teste de Usuários (Frontend)</h1>

<p id="status">Carregando usuários...</p>

<ul id="users-list"></ul>

<script type="module">
    import { listUsers } from "./js/users.js";
    import { getToken, logout } from "./js/auth.js";

    /**
     * Validação simples de autenticação
     */
    if (!getToken()) {
        console.warn("Usuário não autenticado. Redirecionando...");
        logout();
    }

    /**
     * Carrega usuários do backend
     */
    async function carregarUsuarios() {
        const statusEl = document.getElementById("status");
        const listEl = document.getElementById("users-list");

        try {
            const users = await listUsers();

            listEl.innerHTML = "";

            if (!users || users.length === 0) {
                statusEl.textContent = "Nenhum usuário encontrado";
                return;
            }

            statusEl.textContent = "Usuários carregados com sucesso";

            users.forEach(user => {
                const li = document.createElement("li");
                li.textContent = `
                    ID: ${user.id} |
                    Username: ${user.username} |
                    Email: ${user.email || "-"} |
                    Ativo: ${user.is_active}
                `;
                listEl.appendChild(li);
            });

        } catch (error) {
            statusEl.textContent = "Erro ao carregar usuários";
            console.error("Erro:", error);
        }
    }

    carregarUsuarios();
</script>

</body>
</html>
